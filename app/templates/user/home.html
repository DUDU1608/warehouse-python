<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <title>वेयरहाउस डैशबोर्ड</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Bootstrap + Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>

  <style>
    :root{
      --brand:#2c7a3f;         /* agri green */
      --brand-2:#3aa35a;
      --ink:#1f2937;           /* text */
      --muted:#6b7280;         /* secondary text */
      --line:#e9eef3;          /* borders */
      --card:#ffffff;
      --accent:#f39c12;        /* warm orange */
      --radius:16px;
      --shadow:0 10px 28px rgba(0,0,0,.08);
    }

    /* Background */
    body{
      background:
        radial-gradient(1000px 700px at 110% -10%, rgba(60,179,113,.08), transparent 60%),
        radial-gradient(800px 600px at -10% 110%, rgba(139,195,74,.08), transparent 50%),
        linear-gradient(135deg, #f7fafc 55%, #eef5ff 100%);
      min-height:100vh;
      color:var(--ink);
      font-family: "Segoe UI", system-ui, -apple-system, Roboto, Arial, sans-serif;
    }

    /* Navbar */
    .navbar{
      background: rgba(255,255,255,.9)!important;
      backdrop-filter: saturate(130%) blur(8px);
      box-shadow: 0 8px 24px rgba(0,0,0,.06);
    }
    .brand-title{ font-weight:800; margin:0; }
    .btn-brand{
      background: linear-gradient(90deg, var(--brand), var(--brand-2));
      color:#fff; border:none; border-radius:10px; padding:10px 16px;
      box-shadow: 0 10px 22px rgba(42,122,63,.25);
    }
    .btn-brand:hover{ opacity:.95; transform: translateY(-1px); }

    /* Flash Notice */
    .flash-wrap{
      background:#fff1f2; border:1px solid #fecaca; border-radius:12px;
      padding:.75rem 1rem; box-shadow: var(--shadow);
    }
    .flash-red{
      color:#dc2626; font-weight:800; animation: flash 1.1s ease-in-out infinite;
    }
    @keyframes flash{
      0%,100% {opacity:1}
      50%     {opacity:.35}
    }

    /* Layout */
    .card-glass{
      background: var(--card);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    .profile-card{ padding:20px; }
    .avatar{
      width:64px; height:64px; border-radius:50%;
      display:grid; place-items:center;
      background:#eef7f0; color:var(--brand); font-weight:800; font-size:1.2rem;
      border:1px solid #d9eee0;
    }
    .role-badge{ font-size:.85rem; }
    .kpi{
      border:1px dashed var(--line); border-radius:12px; padding:10px; text-align:center;
    }
    .kpi h6{ margin:0; font-weight:800; }
    .kpi small{ color:var(--muted); }

    /* Module Cards */
    .mod-card{
      padding:18px; height:100%;
      transition: .18s ease transform, .18s ease box-shadow;
    }
    .mod-card:hover{ transform: translateY(-3px); box-shadow: 0 12px 28px rgba(0,0,0,.10); }
    .mod-head{ display:flex; align-items:center; gap:12px; margin-bottom:8px; }
    .mod-icon{
      width:46px; height:46px; border-radius:10px; display:flex; align-items:center; justify-content:center;
      background:#eef7f0; color:var(--brand); font-size:1.2rem; border:1px solid #d9eee0;
    }
    .muted{ color:var(--muted); }

    /* Floating Chat Button */
    .fab-chat{
      position: fixed; right: 20px; bottom: 20px; z-index: 999;
      border-radius: 999px; padding: 12px 16px; font-weight:700;
      display:flex; align-items:center; gap:8px;
      box-shadow: 0 12px 28px rgba(0,0,0,.18);
      animation: pulse 1.8s ease-in-out infinite;
    }
    @keyframes pulse{
      0%{ transform: translateY(0); box-shadow: 0 12px 28px rgba(0,0,0,.18);}
      50%{ transform: translateY(-2px); box-shadow: 0 16px 34px rgba(0,0,0,.22);}
      100%{ transform: translateY(0); box-shadow: 0 12px 28px rgba(0,0,0,.18);}
    }

    /* Responsive tweaks */
    @media (max-width: 576px){
      .avatar{ width:56px; height:56px; font-size:1.05rem; }
    }
  </style>
</head>
<body>

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg py-2">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center gap-2" href="/">
        <i class="bi bi-box-seam-fill text-success fs-4"></i>
        <span class="brand-title">वेयरहाउस डैशबोर्ड</span>
      </a>
      <div class="ms-auto d-flex align-items-center gap-2">
       
          <i class="bi bi-chat-dots me-1"></i> चैट सहायता
        </a>
        <a href="{{ url_for('user_auth.logout') }}" class="btn btn-danger">
          <i class="bi bi-box-arrow-right me-1"></i> लॉगआउट
        </a>
      </div>
    </div>
  </nav>

  <!-- FLASH NOTICE -->
  <div class="container mt-3">
    <div class="flash-wrap text-center" role="alert" aria-live="polite">
      <span class="flash-red">
        <span class="me-1">⚠️</span>
        यदि आपके कोई प्रश्न हैं, तो कृपया <strong>चैट</strong> बटन पर क्लिक करके चैट मॉड्यूल का उपयोग करें।
      </span>
    </div>
  </div>

  <!-- MAIN -->
  <div class="container my-4">
    <div class="row g-3">
      <!-- Left: Profile / Summary -->
      <div class="col-12 col-lg-4">
        <div class="card-glass profile-card">
          <div class="d-flex align-items-center gap-3">
            <div class="avatar">
              {% set initials = (display_name or 'यूज़र')[:2] %}
              {{ initials }}
            </div>
            <div>
              <h5 class="mb-0">स्वागत है, {{ display_name }}</h5>
              <small class="text-muted">आपका केंद्रीकृत नियंत्रण पैनल</small>
            </div>
          </div>

          <hr class="my-3">

          <div class="d-flex flex-wrap gap-2">
            {% if is_seller %}
              <span class="badge rounded-pill text-bg-primary role-badge"><i class="bi bi-person-badge me-1"></i> सेलर</span>
            {% endif %}
            {% if is_stockist %}
              <span class="badge rounded-pill text-bg-success role-badge"><i class="bi bi-person-gear me-1"></i> स्टॉकिस्ट</span>
            {% endif %}
          </div>

          <div class="row g-2 mt-3">
            <div class="col-6">
              <div class="kpi">
                <h6 id="kpiPurchases">—</h6>
                <small>आज की खरीद</small>
              </div>
            </div>
            <div class="col-6">
              <div class="kpi">
                <h6 id="kpiPayments">—</h6>
                <small>आज के भुगतान</small>
              </div>
            </div>
          </div>

          <div class="mt-3">
            <a href="/assistant/account" class="btn btn-brand w-100">
              <i class="bi bi-chat-dots me-1"></i> चैट सहायता खोलें
            </a>
          </div>
        </div>
      </div>

      <!-- Right: Modules -->
      <div class="col-12 col-lg-8">
        <div class="row g-3">
          {% if is_seller %}
          <div class="col-12 col-md-6">
            <div class="card-glass mod-card h-100">
              <div class="mod-head">
                <div class="mod-icon"><i class="bi bi-cart-check"></i></div>
                <div>
                  <h5 class="mb-0">सेलर मॉड्यूल</h5>
                  <small class="muted">खरीद, भुगतान, देय रिपोर्ट</small>
                </div>
              </div>
              <p class="muted mb-3">अपने लेनदेन और रिपोर्ट्स को आसानी से मैनेज करें।</p>
              <a href="/user/seller" class="btn btn-outline-primary">
                <i class="bi bi-speedometer2 me-1"></i> सेलर डैशबोर्ड देखें
              </a>
            </div>
          </div>
          {% endif %}

          {% if is_stockist %}
          <div class="col-12 col-md-6">
            <div class="card-glass mod-card h-100">
              <div class="mod-head">
                <div class="mod-icon"><i class="bi bi-boxes"></i></div>
                <div>
                  <h5 class="mb-0">स्टॉकिस्ट मॉड्यूल</h5>
                  <small class="muted">स्टॉक, एंट्री/एग्ज़िट, मार्जिन</small>
                </div>
              </div>
              <p class="muted mb-3">रियल-टाइम स्टॉक और लाभ का ट्रैक रखें।</p>
              <a href="/user/stockist" class="btn btn-outline-success">
                <i class="bi bi-speedometer me-1"></i> स्टॉकिस्ट डैशबोर्ड देखें
              </a>
            </div>
          </div>
          {% endif %}

          <!-- Helpful Links -->
          <div class="col-12">
            <div class="card-glass mod-card">
              <div class="mod-head">
                <div class="mod-icon"><i class="bi bi-journal-text"></i></div>
                <div>
                  <h5 class="mb-0">सहायक लिंक</h5>
                  <small class="muted">त्वरित सहायता व मार्गदर्शन</small>
                </div>
              </div>
              <div class="d-flex flex-wrap gap-2">
                <a href="/faq" class="btn btn-outline-secondary btn-sm"><i class="bi bi-question-circle me-1"></i> FAQ</a>
                <a href="/how-to" class="btn btn-outline-secondary btn-sm"><i class="bi bi-journal-richtext me-1"></i> उपयोग गाइड</a>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div><!-- /row -->
  </div><!-- /container -->

  <!-- Floating Chat Button (mobile-visible, always accessible) -->
  <a href="/assistant/account" class="btn btn-brand fab-chat">
    <i class="bi bi-chat-dots"></i> चैट
  </a>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" defer></script>

  <!-- Optional: lightweight demo numbers for KPIs -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const purchases = document.getElementById('kpiPurchases');
      const payments = document.getElementById('kpiPayments');
      // You can replace with real numbers via Jinja if you have them:
      // e.g., {{ today_purchases or 0 }}
      let p=0, pay=0;
      const animate=(el,target)=> {
        const dur=600, start=performance.now();
        const step=(t)=>{
          const k=Math.min(1, (t-start)/dur);
          el.textContent = Math.round(target*k).toLocaleString('en-IN');
          if(k<1) requestAnimationFrame(step);
        };
        requestAnimationFrame(step);
      };
      animate(purchases, p);
      animate(payments, pay);
    });
  </script>
</body>
</html>
